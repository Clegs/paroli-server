<!DOCTYPE html>
<html>
<head><title>configloader.coffee</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" media="all" href="docco.css"/>
</head>
<body>
<div id="container">
    <div id="background"></div>
    <table cellpadding="0" cellspacing="0">
        <thead>
        <tr>
            <th class="docs"><h1> configloader.coffee </h1></th>
            <th class="code"></th>
        </tr>
        </thead>
        <tbody>
        <tr id="section-1">
            <td class="docs">
                <div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div>
                <p>Reads the config file and returnes the configuration as an object</p></td>
            <td class="code">
                <div class="highlight">
                    <pre><span class="nv">fs = </span><span class="nx">require</span> <span
                            class="s">&#39;fs&#39;</span></pre>
                </div>
            </td>
        </tr>
        <tr id="section-2">
            <td class="docs">
                <div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div>
                <p>Default values. Don't edit these, instead configure the 'config' file.</p></td>
            <td class="code">
                <div class="highlight"><pre><span class="nv">module.exports =</span>
  <span class="nv">name: </span><span class="s">&quot;Paroli Server&quot;</span>
  <span class="nv">port: </span><span class="mi">6743</span>

<span class="nv">data = </span><span class="nx">fs</span><span class="p">.</span><span
                            class="nx">readFileSync</span> <span class="s">&#39;./config&#39;</span><span
                            class="p">,</span> <span class="s">&#39;utf8&#39;</span>
<span class="nv">lines = </span><span class="nx">data</span><span class="p">.</span><span class="nx">split</span> <span
                            class="s">&#39;\n&#39;</span>

<span class="k">for</span> <span class="nx">line</span> <span class="k">in</span> <span class="nx">lines</span>
  <span class="nv">line = </span><span class="nx">line</span><span class="p">.</span><span class="nx">trim</span><span
                            class="p">()</span>
  <span class="k">if</span> <span class="nx">line</span><span class="p">.</span><span class="nx">length</span> <span
                            class="o">is</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="c1"># Empty line</span>
  <span class="k">if</span> <span class="nx">line</span><span class="p">.</span><span class="nx">substring</span> <span
                            class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span
                            class="o">is</span> <span class="s">&#39;#&#39;</span>
    <span class="k">return</span> <span class="c1"># Comment, do nothing</span>
  
  <span class="nv">space = </span><span class="nx">line</span><span class="p">.</span><span
                            class="nx">indexOf</span> <span class="s">&#39; &#39;</span>
  <span class="k">if</span> <span class="nx">space</span> <span class="o">is</span> <span class="o">-</span><span
                            class="mi">1</span>
    <span class="k">return</span>
  
  <span class="k">if</span> <span class="nx">space</span> <span class="o">is</span> <span class="nx">line</span><span
                            class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span
                            class="mi">1</span>
    <span class="k">return</span>
  
  <span class="nv">key = </span><span class="nx">line</span><span class="p">.</span><span
                            class="nx">substring</span> <span class="mi">0</span><span class="p">,</span> <span
                            class="nx">space</span>
  <span class="nv">value = </span><span class="nx">line</span><span class="p">.</span><span class="nx">substring</span> <span
                            class="nx">space</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="k">unless</span> <span class="nb">isNaN</span> <span class="nx">value</span>
    <span class="nv">value = </span><span class="nb">parseInt</span> <span class="nx">value</span>
  
  <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">[</span><span
                            class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span></pre>
                </div>
            </td>
        </tr>
        <tr id="section-3">
            <td class="docs">
                <div class="pilwrap"><a class="pilcrow" href="#section-3">&#182;</a></div>
                <p><a href="http://c9.io">Cloud9</a> Support - Has not been tested.</p></td>
            <td class="code">
                <div class="highlight"><pre><span class="nv">module.exports.port = </span><span
                        class="nx">process</span><span class="p">.</span><span class="nx">env</span><span
                        class="p">.</span><span class="nx">PORT</span> <span class="k">if</span> <span class="nx">process</span><span
                        class="p">.</span><span class="nx">env</span><span class="p">.</span><span
                        class="nx">PORT</span><span class="o">?</span>

</pre>
                </div>
            </td>
        </tr>
        </tbody>
    </table>
</div>
</body>
</html>